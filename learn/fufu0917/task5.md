## 第五章：Monad 101

1. 请简述 Monad 中的“延迟执行”概念。该机制如何优化共识与执行之间的关系？

- 在 Monad 共识机制中，“延迟执行”是一种设计理念，它将交易的“共识确定” 与“状态执行”解耦。这意味着交易在区块中被共识确定之后，并不会立即执行，而是推迟到后续专门的执行阶段再进行。Monad 的延迟执行机制通过将交易排序与状态更新分离，使得共识可以轻量、快速并专注于确定交易顺序，而执行层则可以并行、高效地处理状态变化，从而同时提升安全性、吞吐量和可扩展

2. 什么是乐观并行执行？其工作流程包含哪些关键步骤？

- 乐观并行执行是一种“先并行、后验证”的区块链交易执行策略，它能在保证一致性的同时显著提升执行效率。
- 包含的步骤
  乐观执行：乐观地假设所有交易都有相同的初始状态
  生成待处理结果：记账：记录哪些存储槽被读取或修改
  提交处理结果：按照原始顺序提交待处理结果，以保持现行排序属性
  重新执行（如需）：重新执行那些输入数据已发生变化的交易

3. 在 Monad 架构中，如何通过并行执行仍保持交易的线性排序与状态一致性？

- Monad 利用 DAG 表示并行交易中的依赖关系，确保最终状态变更符合共识排序，即便执行是并行的，结果仍是确定的、线性的一致状态转移轨迹。

4. Monad 的共识机制 monadBFT 有哪些特点？它与传统 BFT 共识相比有何优势？

- 特点：
  1. 专注于排序而非执行：monadBFT 的职责是快速排序交易，并将排序后的交易广播给验证节点；不负责交易执行（执行发生在排序之后的并行执行阶段）；这样实现了“共识和执行解耦”，提高整体吞吐量。
  2. 部分异步拜占庭容错（pBFT）变种，类似于经典的 pBFT：有 Leader、Prepare、Commit 阶段；但是：为了高并发优化了网络广播和验证流程；支持更快的交易确认。
  3. Leader 提议交易批次（blocks）：每个共识轮次中，Leader 收集来自客户端的交易，打包成一个提案（block）；所有节点达成一致后进入执行阶段。
  4. 容错能力强：可容忍最多 f 个拜占庭节点的存在（当总节点数 ≥ 3f + 1）；保证安全性（不产生冲突区块）和活性（系统可持续推进）。
- 于传统 BFT 共识相比：
  在共识角色方面 monadBFT 仅负责交易排序，传统则是排序和执行绑定在一起
  在执行方式，monadBFT 延迟执行（后执行、并行），传统则是即时执行（共识前需本地执行）
  在吞吐量，monadBFT 极高（>10,000 TPS 理论上）,传统则是有限（数百~千级 TPS）
  在确认延迟方面，monadBFT 是亚秒级确认，传统通常为数秒
  资源消耗，monadBFT 更低，传统执行压力集中于共识过程
  确定性方面，monadBFT 强（状态根完全由交易排序 + DAG 执行决定），传统强，但易受 leader 停滞等影响
  可扩展性方面，mondadBFT 高（执行可线性扩展）,传统有限（共识执行耦合）

5. 为什么 Monad 采用“Optimistic Concurrency Control”？它在处理交易冲突方面是如何工作的？

- Monad 采用“Optimistic Concurrency Control”,是因为这种机制在面对大量并发交易时,能够显著提高吞吐量并降低执行延迟。它是 Monad 高性能并行执行设计的关键组成部分
- 非冲突情况下并行执行，直接提交结果；写冲突，根据排序顺序执行第一个交易，后者检测到冲突后回滚重试；读写冲突，交易会因状态变化检测失败，需重试
