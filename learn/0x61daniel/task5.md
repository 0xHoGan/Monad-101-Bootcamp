## 第五章：Monad 101

1. 请简述 Monad 中的“延迟执行”概念。该机制如何优化共识与执行之间的关系？
   Monad 中的 “延迟执行” 指计算不会在表达式定义时立即执行，而是将操作封装在 Monad 结构中形成待执行链，直到需要结果时才触发实际计算。
   共识效率提升：验证节点只需快速验证交易签名和顺序，无需等待执行结果，缩短出块时间
   资源利用率优化：执行阶段可并行处理历史区块，充分利用计算资源

2. 什么是乐观并行执行？其工作流程包含哪些关键步骤？
   乐观并行执行假设多个操作之间无冲突，先并行执行操作并生成临时结果，再通过验证机制确认结果的正确性，步骤：
   交易顺序排序：
   按区块顺序确定全局执行顺序，解决并行执行中的顺序歧义
   无锁执行：
   并行执行交易，不依赖显式锁机制。
   冲突检测：
   执行后分析读写集，检查状态冲突。
   结果提交/回滚：
   若无冲突，提交结果；否则回滚并重新串行执行冲突交易

3. 在 Monad 架构中，如何通过并行执行仍保持交易的线性排序与状态一致性？
   Monad 通过以下机制实现：
   确定性全局排序
   共识层（如 MonadBFT）对所有交易生成确定性排序，确保所有节点按相同顺序处理交易。
   依赖分析与分组
   分析交易间的读写依赖关系，将无依赖的交易划分为并行组（Batch），有依赖的交易保持顺序执行。
   乐观并行执行
   各执行单元并行处理分组内交易，生成临时状态变更（不立即提交）。
   状态版本控制
   每个交易关联输入状态的版本号（如状态根哈希），执行前校验版本是否匹配，确保基于最新状态执行。
   后验一致性验证
   按全局排序顺序合并各分组的执行结果，验证最终状态根哈希是否一致，确保无冲突。
   冲突检测与回滚
   若验证发现冲突（如状态版本不匹配），回滚冲突分组，重新按序执行。
   最终状态提交
   所有验证通过后，按全局排序提交状态变更，保证最终状态与串行执行结果一致。

4. Monad 的共识机制 monadBFT 有哪些特点？它与传统 BFT 共识相比有何优势？
   MonadBFT 特点：
   分层架构设计
   两层共识结构：区块提议层/确认层，减少分叉可能性。
   异步网络支持
   优化消息传递机制，在网络延迟较高或部分节点故障时仍能保持活性。
   动态委员会调整
   支持验证者集合的动态调整，可根据网络状态或权益变化实时更新共识节点，提升安全性与可扩展性。
   交易并行处理
   与 Monad 架构的并行执行引擎深度整合，共识层仅确定交易顺序，执行层可并行处理无依赖交易，大幅提升 TPS。
   轻量级验证
   采用简洁的消息结构和验证逻辑，减少共识节点间的通信开销，降低延迟。

5. 为什么 Monad 采用“Optimistic Concurrency Control”？它在处理交易冲突方面是如何工作的？
   采用 OCC 的原因：
   提升并行执行效率
   假设多数交易无冲突，允许先并行执行，后验证冲突，大幅减少阻塞，提升吞吐量。
   适配并行执行架构
   Monad 的执行层支持多交易组并行处理，OCC 能与这种架构深度协同，避免因预检查冲突拖慢执行速度，尤其适合高频、低冲突场景（如 DeFi 批量转账）。
   冲突处理机制：
   并行处理无依赖交易
   按共识层确定的全局顺序，将交易划分为无依赖的分组，分配至不同执行单元并行执行。
   临时状态变更
   执行过程中生成临时状态修改，不立即提交到全局状态，仅记录变更日志和版本号。
   冲突验证
   按共识排序逐个验证交易组的执行结果，验证交易组的读写集合是否与之前已提交的交易存在未被识别的隐式依赖。
   提交 / 回滚
   无冲突交易提交，若发现冲突，回滚该交易组的所有临时变更，恢复至执行前的状态，并按全局顺序重新执行冲突交易。
